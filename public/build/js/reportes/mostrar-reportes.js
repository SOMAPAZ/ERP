(()=>{const e=document.querySelector("#listado-reportes"),a=document.querySelectorAll("input[name='estado-reporte']"),t=document.querySelector("#total-reportes"),n=document.querySelector("#titulo-estado"),r=document.querySelector("#categoria-select"),d=document.querySelector("#incidencia-select"),s=document.querySelector("#prioridad-select"),o=document.querySelector("#filtros-select");let l=[],c=[],i=0,p=[],g=[],m=[],u="1";class y{constructor({url:e,arreglo:a,input:t}){this.url=e,this.arreglo=a,this.input=t,this.obtenerDatos()}async obtenerDatos(){try{const e=await fetch(this.url),a=await e.json();this.arreglo=a,this.renderizarDatos()}catch(e){console.log(e)}}renderizarDatos(){this.arreglo.forEach((e=>{const a=document.createElement("OPTION");a.value=e.id,a.textContent=e.name,this.input.appendChild(a)}))}}function f(){b(),h(),i=c.length,t.textContent=`(${i})`,c.forEach((a=>{const{folio:t,usuario:n,direccion:r,emision:d,categoria:s,incidencia:o,prioridad:l,priorityColor:i}=a,p=document.createElement("DIV");p.className="space-y-4 py-2 md:py-4";const g=document.createElement("DIV");g.className="grid grid-cols-1 md:grid-cols-2 gap-4";const m=document.createElement("A");m.className="text-xl font-extrabold text-gray-900 dark:text-white uppercase hover:underline",m.href=`/reporte?folio=${t}`,m.innerHTML=`Folio: <span class="font-semibold ms-2">${t}</span>`;const u=document.createElement("DIV"),y=document.createElement("SPAN");y.className=`inline-block rounded bg-${i}-100 px-2.5 py-0.5 text-xs font-extrabold text-${i}-800 dark:bg-${i}-900 dark:text-${i}-300 md:mb-0 uppercase`,y.textContent=l,u.appendChild(y),g.appendChild(m),g.appendChild(u);const v=document.createElement("DIV");v.className="grid md:grid-cols-2 gap-2 md:gap-6 col-span-2 text-base text-gray-900 dark:text-white";const h=document.createElement("DIV");h.className="space-y-2";const b=document.createElement("DIV");b.className="flex flex-col md:flex-row md:gap-2";const x=document.createElement("P");x.className="block font-bold py-1",x.innerHTML=`Usuario: <span class="font-normal text-gray-500 dark:text-gray-400"> ${n} </span>`,b.appendChild(x),h.appendChild(b);const k=document.createElement("DIV");k.className="flex flex-col md:flex-row md:gap-2";const w=document.createElement("P");w.className="block font-bold py-1",w.innerHTML=`Dirección: <span class="font-normal text-gray-500 dark:text-gray-400"> ${r} </span>`,k.appendChild(w),h.appendChild(k);const C=document.createElement("DIV");C.className="flex flex-col md:flex-row md:gap-2";const E=document.createElement("P");E.className="block font-bold py-1",E.innerHTML=`Emisión: <span class="font-normal text-gray-500 dark:text-gray-400"> ${d} </span>`,C.appendChild(E),h.appendChild(C);const D=document.createElement("DIV");D.className="space-y-2";const I=document.createElement("DIV");I.className="flex flex-col md:flex-row md:gap-2";const N=document.createElement("P");N.className="block font-bold py-1",N.innerHTML=`Categoría: <span class="font-normal text-gray-500 dark:text-gray-400"> ${s} </span>`,I.appendChild(N),D.appendChild(I);const L=document.createElement("DIV");L.className="flex flex-col md:flex-row md:gap-2";const T=document.createElement("P");T.className="block font-bold py-1",T.innerHTML=`Incidencia: <span class="font-normal text-gray-500 dark:text-gray-400"> ${o} </span>`,L.appendChild(T),D.appendChild(L);const V=document.createElement("DIV");V.className="flex justify-center md:justify-end gap-1 col-span-2 md:col-span-1";const $=document.createElement("DIV"),j=document.createElement("A");j.className="flex items-center justify-center w-full uppercase bg-blue-600 text-font-light text-xs py-2 px-6 rounded-md shadow-md hover:bg-blue-500 gap-2",j.href=`/reporte?folio=${t}`,j.innerHTML='\n        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" /></svg>\n        <p class="font-bold text-xs">Acceder</p>\n      ';const M=document.createElement("DIV"),S=document.createElement("BUTTON");S.className="flex items-center justify-center w-full uppercase bg-red-600 text-font-light text-xs py-2 px-6 rounded-md shadow-md hover:bg-red-500 gap-2",S.innerHTML='\n        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" /></svg>\n        <p class="font-bold text-xs">Eliminar</p>\n      ',S.onclick=()=>{!function(e){Swal.fire({title:`¿Estás seguro de eliminar el reporte ${e}?`,text:"Esta acción no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"}).then((a=>{a.isConfirmed&&async function(e){const a=new FormData;a.append("folio",e);try{const e="http://localhost:5000/api/reporte/eliminar",t=await fetch(e,{method:"POST",body:a}),n=await t.json();"Exito"===n.tipo&&(Swal.fire({title:n.tipo,text:n.mensaje,icon:"success"}),c=[...c].filter((e=>e.folio!==n.folio)),f())}catch(e){console.log(e)}}(e)}))}(a.folio)},$.appendChild(j),M.appendChild(S),V.appendChild($),V.appendChild(M),D.appendChild(V),v.appendChild(h),v.appendChild(D),p.appendChild(g),p.appendChild(v),e.appendChild(p)}))}function v(e){u=e.target.value;const a=e.target.id;n.innerHTML=`Reportes ${a}`,c=[...l].filter((e=>e.statusID===u)),o.reset(),f()}function h(){for(;e.firstChild;)e.removeChild(e.firstChild)}function b(){h();const a=document.createElement("DIV");a.id="loader",a.innerHTML='\n    <div id="loader" class="mt-6">\n        <div class="animate-pulse mt-10">\n            <div class="py-2.5 rounded bg-gray-300 dark:bg-gray-400 w-48"></div>\n            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-3">\n                <div class="py-2 bg-gray-300 dark:bg-gray-400 rounded"></div>\n                <div class="py-2 bg-gray-300 dark:bg-gray-400 rounded"></div>\n                <div class="py-2 bg-gray-300 dark:bg-gray-400 rounded"></div>\n                <div class="py-2 bg-gray-300 dark:bg-gray-400 rounded"></div>\n                <div>\n                    <div class="py-2 bg-gray-300 dark:bg-gray-400 rounded"></div>\n                </div>\n                <div class="flex justify-end gap-4">\n                    <span class="py-4 bg-gray-300 dark:bg-gray-400 rounded w-32"></span>\n                    <span class="py-4 bg-gray-300 dark:bg-gray-400 rounded w-32"></span>\n                </div>\n            </div>\n        </div>\n        <div class="animate-pulse mt-10">\n            <div class="py-2.5 rounded bg-gray-300 dark:bg-gray-400 w-48"></div>\n            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-3">\n                <div class="py-2 bg-gray-300 dark:bg-gray-400 rounded"></div>\n                <div class="py-2 bg-gray-300 dark:bg-gray-400 rounded"></div>\n                <div class="py-2 bg-gray-300 dark:bg-gray-400 rounded"></div>\n                <div class="py-2 bg-gray-300 dark:bg-gray-400 rounded"></div>\n                <div>\n                    <div class="py-2 bg-gray-300 dark:bg-gray-400 rounded"></div>\n                </div>\n                <div class="flex justify-end gap-4">\n                    <span class="py-4 bg-gray-300 dark:bg-gray-400 rounded w-32"></span>\n                    <span class="py-4 bg-gray-300 dark:bg-gray-400 rounded w-32"></span>\n                </div>\n            </div>\n        </div>\n        <div class="animate-pulse mt-10">\n            <div class="py-2.5 rounded bg-gray-300 dark:bg-gray-400 w-48"></div>\n            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-3">\n                <div class="py-2 bg-gray-300 dark:bg-gray-400 rounded"></div>\n                <div class="py-2 bg-gray-300 dark:bg-gray-400 rounded"></div>\n                <div class="py-2 bg-gray-300 dark:bg-gray-400 rounded"></div>\n                <div class="py-2 bg-gray-300 dark:bg-gray-400 rounded"></div>\n                <div>\n                    <div class="py-2 bg-gray-300 dark:bg-gray-400 rounded"></div>\n                </div>\n                <div class="flex justify-end gap-4">\n                    <span class="py-4 bg-gray-300 dark:bg-gray-400 rounded w-32"></span>\n                    <span class="py-4 bg-gray-300 dark:bg-gray-400 rounded w-32"></span>\n                </div>\n            </div>\n        </div>\n    </div>\n    ',e.appendChild(a)}function x(){c=[...l].filter((e=>e.statusID===u))}document.addEventListener("DOMContentLoaded",(()=>{b(),async function(){try{const e="http://localhost:5000/api-reportes",a=await fetch(e),t=await a.json();l=t,c=[...l].filter((e=>e.statusID===u)),f()}catch(e){console.log(e)}}(),new y({url:"http://localhost:5000/api/categorias",arreglo:p,input:r}),new y({url:"http://localhost:5000/api/incidencias",arreglo:m,input:d}),new y({url:"http://localhost:5000/api/prioridades",arreglo:g,input:s}),a.forEach((e=>{e.addEventListener("click",v)}))})),r.addEventListener("change",(e=>{x();const a=e.target.value;c=[...c].filter((e=>e.categoryID===a)),f()})),d.addEventListener("change",(e=>{x();const a=e.target.value;c=[...c].filter((e=>e.incidenceID===a)),f()})),s.addEventListener("change",(e=>{x();const a=e.target.value;c=[...c].filter((e=>e.priorityID===a)),f()}))})();