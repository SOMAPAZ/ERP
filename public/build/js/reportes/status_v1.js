import GetDatos from"../classes/GetData_v1.js";import PostDatos from"../classes/PostData_v1.js";import Alerta from"../classes/Alerta_v1.js";import{getSearch}from"../helpers/index_v1.js";(()=>{const t=document.querySelectorAll("#ol-status button"),e=document.querySelector("#status-1 button"),a=document.querySelector("#status-2 button"),r=document.querySelector("#status-3 button"),s=document.querySelector("#status-4 button");let o=1;const n=document.querySelector("#incidencia-id").value;document.addEventListener("DOMContentLoaded",(()=>{i(),e.addEventListener("click",(()=>c(e.dataset.status))),a.addEventListener("click",(()=>c(a.dataset.status))),r.addEventListener("click",(()=>c(r.dataset.status))),s.addEventListener("click",(()=>c(s.dataset.status)))}));const i=async()=>{const t=`${location.origin}/reporte/estado?folio=${getSearch().folio}`,e=await GetDatos.consultar(t);o=Number(e),d()},c=t=>{"3"===t&&("7"===n||"9"===n||"10"===n||"11"===n||"12"===n||"13"===n||"20"===n||"21"===n||"39"===n)?Swal.fire({title:"Requiere confirmación",text:"¿Confirma que el usuario ya pagó el servicio correspondiente?",icon:"warning",showCancelButton:!0,confirmButtonText:"Confirmar pago",cancelButtonText:"Cancelar"}).then((e=>{e.isConfirmed?l(t):Swal.fire("Changes are not saved","","info")})):l(t)},l=async t=>{const e=`${location.origin}/reporte/estado/actualizar`,a=Number(t),r=[a,getSearch().folio],s=await PostDatos.enviarArray(e,r);"Exito"===s.tipo&&(Alerta.Toast.fire({icon:"success",title:"Cambio exitoso",text:s.msg}),o=a,d())},d=()=>{t.forEach((t=>{const e=Number(t.dataset.status),a=t.parentElement;e<=o&&(a.classList.remove("text-gray-500","dark:text-gray-400"),a.classList.add("text-blue-600","dark:text-blue-500"),t.classList.remove("border","border-gray-500","dark:border-gray-400"),t.classList.add("bg-blue-100","dark:bg-blue-800"),t.innerHTML='<svg class="w-3.5 h-3.5 text-blue-600 lg:w-4 lg:h-4 dark:text-blue-300" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 12"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 5.917 5.724 10.5 15 1.5"/></svg>'),e>o&&(a.classList.add("text-gray-500","dark:text-gray-400"),a.classList.remove("text-blue-600","dark:text-blue-500"),t.classList.add("border","border-gray-500","dark:border-gray-400"),t.classList.remove("bg-blue-100","dark:bg-blue-800"),t.innerHTML="",t.textContent=e)}))}})();