import GetDatos from"../classes/GetData_v1.js";import Alerta from"../classes/Alerta_v1.js";import{formatDateD,limpiarHTML}from"../helpers/index_v1.js";(()=>{const e=document.querySelector("#tanque_id"),t=document.querySelector("#number_mes"),a=document.querySelector("#number_year"),o=document.querySelector("#enviar-form"),r=document.querySelector("#contenedor-graficas");let n,s,i=[],d=[],l=[],c={tanqueId:"",mes:"",year:""};document.addEventListener("DOMContentLoaded",(function(){m(),e.addEventListener("change",p),t.addEventListener("change",(e=>c={...c,mes:+e.target.value})),a.addEventListener("change",(e=>c={...c,year:+e.target.value})),o.addEventListener("submit",u)}));const m=async()=>{const e=`${location.origin}/tanques`;s=await GetDatos.consultar(e),h()},h=()=>{s.forEach((t=>{const a=document.createElement("OPTION");a.value=t.id,a.textContent=t.nombre,e.appendChild(a)}))},p=e=>{""!==e.target.value&&(n=s.find((t=>t.id===e.target.value)),c={...c,tanqueId:n.id})},u=async e=>{if(e.preventDefault(),Object.values(c).some((e=>""===e)))return void Alerta.Toast.fire({icon:"error",title:"Incompleto",text:"Seleccione todos los parÃ¡metros"});const t=`${location.origin}/tanques-registros?mes=${c.mes}&id_tanque=${c.tanqueId}&year=${c.year}`,a=await GetDatos.consultar(t);if(0===a.length){limpiarHTML(r);const e=document.createElement("P");return e.className="p-4 text-gray-800 bg-white font-bold uppercase dark:text-white dark:bg-gray-600 text-center rounded shadow sin-datos",e.textContent="No hay registros de este periodo o de este tanque",void r.appendChild(e)}f(a)},f=e=>{const t=document.createElement("DIV");t.className="bg-white dark:bg-gray-800 shadow rounded sm:p-5 md:p-10";const a=document.createElement("P");a.className="text-gray-800 font-bold text-sm uppercase dark:text-white text-center pt-5",a.textContent=`Nivel de agua de ${n.nombre}`;const o=document.createElement("DIV");o.className="bg-white dark:bg-gray-800 shadow rounded sm:p-5 md:p-10";const s=document.createElement("P");s.className="text-gray-800 font-bold text-sm uppercase dark:text-white text-center pt-5",s.textContent=`Porcentaje de llegada de ${n.nombre}`,limpiarHTML(r),limpiarHTML(t),limpiarHTML(o),t.appendChild(a),o.appendChild(s),r.appendChild(t),r.appendChild(o),i=[],d=[],l=[],e.forEach((e=>i.push(formatDateD(e.fecha)))),e.forEach((e=>d.push(e.nivel))),e.forEach((e=>l.push(e.llegada)));const c={series:[{name:`Nivel de agua de ${n.nombre}`,data:d}],chart:{type:"line",height:300,toolbar:{show:!1}},title:{show:""},dataLabels:{enabled:!1},colors:["#615fff"],stroke:{lineCap:"round",curve:"smooth"},markers:{size:0},xaxis:{axisTicks:{show:!1},axisBorder:{show:!1},labels:{style:{colors:"#99a1af",fontSize:"12px",fontFamily:"inherit",fontWeight:400}},categories:i},yaxis:{labels:{style:{colors:"#99a1af",fontSize:"12px",fontFamily:"inherit",fontWeight:400}}},grid:{show:!0,borderColor:"#99a1af",strokeDashArray:5,xaxis:{lines:{show:!0}},padding:{top:5,right:20}},fill:{opacity:.8},tooltip:{theme:"dark"}},m={series:[{name:`Porcentaje de llegada de ${n.nombre}`,data:l}],chart:{type:"line",height:300,toolbar:{show:!1}},title:{show:""},dataLabels:{enabled:!1},colors:["#ff6900"],stroke:{lineCap:"round",curve:"smooth"},markers:{size:0},xaxis:{axisTicks:{show:!1},axisBorder:{show:!1},labels:{style:{colors:"#99a1af",fontSize:"12px",fontFamily:"inherit",fontWeight:400}},categories:i},yaxis:{labels:{style:{colors:"#99a1af",fontSize:"12px",fontFamily:"inherit",fontWeight:400}}},grid:{show:!0,borderColor:"#99a1af",strokeDashArray:5,xaxis:{lines:{show:!0}},padding:{top:5,right:20}},fill:{opacity:.8},tooltip:{theme:"dark"}},h=new ApexCharts(t,c),p=new ApexCharts(o,m);h.render(),p.render()}})();