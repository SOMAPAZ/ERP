import{getSearch,limpiarHTML}from"../helpers/index_v4.js";import GetDatos from"../classes/GetData_v1.js";import PostDatos from"../classes/PostData_v1.js";import Alerta from"../classes/Alerta_v1.js";(()=>{const e=document.querySelector("#condonacion-desglose tbody");let t=[];document.addEventListener("DOMContentLoaded",(()=>{a()}));const a=async()=>{const e=getSearch().usuario,a=`${location.origin}/consultar-condonaciones-listado?id=${e}`;t=await GetDatos.consultar(a),o()},o=()=>{if(limpiarHTML(e),0===t.length){const t=document.createElement("TR");t.className="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600";const a=document.createElement("TD");return a.className="px-4 py-5 text-xl font-medium text-gray-900 whitespace-nowrap dark:text-white",a.textContent="No hay datos",a.setAttribute("colspan","5"),t.appendChild(a),void e.appendChild(t)}t.map((t=>{const a=document.createElement("TR");a.className="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",a.dataset.idx=t.id;const o=document.createElement("TD");o.className="px-4 py-2 font-medium text-gray-900 whitespace-nowrap dark:text-white",o.textContent=t.id_user;const r=document.createElement("TD");r.className="px-4 py-2 font-medium text-gray-900 whitespace-nowrap dark:text-white",r.textContent=t.year;const s=document.createElement("TD");s.className="px-4 py-2 uppercase";s.textContent=new Date(t.mes).toLocaleDateString("es-MX",{month:"long"});const d=document.createElement("TD");d.className="px-4 py-2",d.textContent=`$ ${t.monto_agua}`;const c=document.createElement("TD");c.className="px-4 py-2";const i=document.createElement("BUTTON");i.className="text-red-700 dark:text-red-200 font-bold flex items-center justify-center sm:w-full md:w-auto uppercase text-xs py-2 px-6 rounded-sm gap-2",i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 text-red-700 dark:text-red-200"><path stroke-linecap="round" stroke-linejoin="round" d="M15 12H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" /></svg>Deshacer CondonaciÃ³n',i.onclick=()=>n(t.id),c.appendChild(i),a.appendChild(o),a.appendChild(r),a.appendChild(s),a.appendChild(d),a.appendChild(c),e.appendChild(a)}))},n=async e=>{const a=`${location.origin}/deshacer-condonacion?id=${e}`,n=await PostDatos.eliminarDatos(a,e);"Exito"===n.tipo&&(Alerta.Toast.fire({icon:"success",title:"Exito",text:n.mensaje}),t=[...t].filter((t=>t.id!==e)),o())}})();