import Modal from"../classes/Modal_v1.js";import GetDatos from"../classes/GetData_v1.js";import Alerta from"../classes/Alerta_v1.js";import{saveLocalStorage}from"../helpers/index_v1.js";(()=>{const e=document.querySelector("#btn-consto-adicional");let t=[],a={},o=[];document.addEventListener("DOMContentLoaded",(()=>{r(),e.addEventListener("click",n)}));const r=async()=>{const e=`${location.origin}/cuentas-adicionales`;t=await GetDatos.consultar(e)},n=()=>{const e=document.createElement("FORM");e.className="flex flex-col gap-2 p-4 my-5 space-y-2";const o=document.createElement("DIV"),r=document.createElement("LABEL");r.className="block text-sm font-medium text-gray-700 dark:text-gray-400 uppercase my-1",r.textContent="Costo",r.htmlFor="costo";const n=document.createElement("INPUT");n.className="block w-full px-4 py-2 rounded-md border border-gray-200 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white text-sm overflow-hidden text-ellipsis whitespace-nowrap",n.type="number",n.name="costo",n.id="costo",o.appendChild(r),o.appendChild(n);const s=document.createElement("DIV"),d=document.createElement("LABEL");d.className="block text-sm font-medium text-gray-700 dark:text-gray-400 uppercase my-1",d.textContent="Descripción",d.htmlFor="adicional";const l=document.createElement("SELECT");l.className="block w-full px-4 py-2 rounded-md border border-gray-200 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white text-sm overflow-hidden text-ellipsis whitespace-nowrap",l.name="adicional",l.id="adicional",l.onchange=e=>{a=t.find((t=>t.id===e.target.value)),n.value=+a.cantidad??0};const i=document.createElement("OPTION");i.classList.add("text-sm","truncate"),i.value="",i.textContent="-- Seleccione una opción --",l.appendChild(i),t.forEach((e=>{const t=document.createElement("OPTION");t.classList.add("text-xs","truncate"),t.value=e.id,t.textContent=e.cuenta.length>=48?`${e.cuenta.substring(0,48)} ...`:e.cuenta,l.appendChild(t)})),s.appendChild(d),s.appendChild(l),e.appendChild(s),e.appendChild(o);const m=document.createElement("INPUT");m.className="py-2 px-4 bg-green-700 text-white rounded font-semibold text-sm hover:bg-green-800 dark:bg-green-600 dark:hover:bg-green-700",m.type="submit",m.value="Agregar",m.onclick=()=>{""!==l.value&&""!==n.value&&"0"!==n.value?(e.reset(),c()):Alerta.Toast.fire({icon:"error",title:"Campos erroneos",text:"Campos vacíos o valor no agregado"})},Modal.renderModal(e,m)},c=()=>{o.find((e=>e.id===a.id))?Alerta.Toast.fire({icon:"error",title:"El costo ya existe",text:"No se puede agregar el mismo costo"}):(o=[...o,a],saveLocalStorage("costosAdicionales",o),o.forEach((e=>{console.log(e)})))}})();