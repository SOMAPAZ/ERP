(()=>{const e=document.getElementById("idUser"),t=document.getElementById("nombreCompleto"),o=document.getElementById("direccion"),n=document.getElementById("colonia"),a=document.getElementById("zona"),d=document.getElementById("observaciones"),i=document.getElementById("year"),r=document.getElementById("mes"),c=document.getElementById("lectura"),l=document.getElementById("cglobal"),s=document.getElementById("fechregistrada"),m=document.getElementById("fechfinalizacion"),u=document.getElementById("idmedidor"),g=document.getElementById("status"),y=document.getElementById("fevidencia"),f=document.getElementById("idempleado"),E=document.getElementById("volverbutton");document.addEventListener("DOMContentLoaded",(async()=>{!function(){const e=new URLSearchParams(window.location.search),t=e.get("id"),o=e.get("mes"),n=e.get("year");if(t&&o&&n){const e={id:t,mes:o,year:n};localStorage.setItem("lecconsult",JSON.stringify(e))}}(),await async function(){const t=JSON.parse(localStorage.getItem("lecconsult"));if(!t)return;const o=t?.id,n=t?.mes,a=t?.year;try{const d=`${location.origin}/api/medidos?id_user=${o}&mes=${n}&year=${a}`,E=await fetch(d),v=await E.json();console.log(v);const I=v[0]||null;I?.evidencias?(y.src=`/images/${I.evidencias}`,y.addEventListener("click",(()=>{const e=document.getElementById("imgModal");document.getElementById("modalImg").src=y.src,e.style.display="flex"}))):y.textContent="Sin foto",document.getElementById("closeModal").addEventListener("click",(()=>{document.getElementById("imgModal").style.display="none"})),e.textContent=I?.id_user||"valor no definido",i.textContent=I?.year||"valor no definido",r.textContent=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][Number(I?.mes)-1]||"Mes no v√°lido",c.textContent=I?.lectura||"valor no definido",l.textContent=I?.consumo_global||"valor no definido",s.textContent="0000-00-00 00:00:00"===I?.fecha_guardada?"Sin registro de fecha":I?.fecha_guardada||"valor no definido",m.textContent="0000-00-00 00:00:00"===I?.fecha_reporte?"Sin registro de fecha":I?.fecha_reporte||"valor no definido",u.textContent=I?.id_medidor||"valor no definido",g.textContent=I?.id_status||"valor no definido",f.value=I?.id_employment||"",f.textContent=0==I?.id_employment?"Sin registro":`${t.name} ${t.lastname}`}catch(e){console.error(e)}}(),await async function(){const i=e.textContent.trim();if(console.log(i),!i)return;try{const e=`${location.origin}/api/usuario?id=${i}`,r=await fetch(e),c=await r.json();E.href=`/buscar-usuario?id=${i}`,t.textContent=c.user+" "+c.lastname||"valor no definido",o.textContent=c.address||"valor no definido",n.textContent=c.id_colony||"valor no definido",a.textContent=c.id_zone||"valor no definido",d.textContent=c.id_observaciones||"valor no definido"}catch(e){console.error("Error al cargar datos del usuario:",e)}}(),await async function(){const e=f.value.trim();if(console.log(e),""===e)return;try{const t=`${location.origin}/api/bempleados?id=${e}`,o=await fetch(t);if(!o.ok)throw new Error("Error en la respuesta de la API");const n=await o.json();f.textContent=`${n.name} ${n.lastname}`||"valor no definido"}catch(e){console.error("Error al cargar datos del empleado:",e)}}()}))})();