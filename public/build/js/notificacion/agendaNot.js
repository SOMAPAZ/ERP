(()=>{let e=[];document.addEventListener("DOMContentLoaded",(async function(){try{const t=`${location.origin}/notifications`,n=await fetch(t);e=await n.json(),function(){const t=document.getElementById("agenda-container");t.innerHTML="";const n=empleadoId,a=e.filter((e=>1===parseInt(e.id_status)&&e.id_employment==n));if(0===a.length){const e=document.createElement("p");return e.className="text-gray-800 dark:text-gray-400 text-center py-4",e.textContent="No hay registros disponibles.",void t.appendChild(e)}a.forEach((e=>{const n=document.createElement("div");n.id=`notificacion-${e.id_user}`,n.className="bg-white shadow-lg px-6 py-4 border rounded-md dark:bg-gray-800 dark:border-gray-700 dark:text-white";const a=document.createElement("div");a.className="grid grid-cols-1 md:grid-cols-2 gap-4";const s=document.createElement("div");s.className="space-y-2",s.innerHTML=`\n    <p>\n    <strong class="dark:text-white">ID Notificacion:</strong> \n    <span class="text-gray-500">${e.idx}</span>\n  </p>\n  <p>\n    <strong class="dark:text-white">ID Usuario:</strong> \n    <span class="text-gray-500">${e.id_user}</span>\n  </p>\n  <p>\n    <strong class="dark:text-white">Usuario:</strong> \n    <span class="text-gray-500">${e.user}</span>\n  </p>\n  <p>\n    <strong class="dark:text-white">Dirección:</strong> \n    <span class="text-gray-500">${e.address}</span>\n  </p>\n  \n \n`;const o=document.createElement("div");o.className="space-y-2",o.innerHTML=`\n    <p>\n    <strong class="dark:text-white">Zona:</strong> \n    <span class="text-gray-500">${e.zona}</span>\n  </p>\n  <p>\n    <strong class="dark:text-white">Colonia:</strong> \n    <span class="text-gray-500">${e.colonia}</span>\n  </p>\n  <p>\n    <strong class="dark:text-white">Meses Rezagados:</strong> \n    <span class="text-gray-500">${e.meses_rezagados}</span>\n  </p>\n  <p>\n    <strong class="dark:text-white">Total:</strong> \n    <span class="text-gray-500">$ ${e.total}</span>\n  </p>\n  \n`;const r=document.createElement("div");r.className="flex justify-center gap-2 md:gap-8 col-span-2 mt-4 grid grid-cols-1 md:grid-cols-3";const i=document.createElement("a");i.className="flex items-center justify-center uppercase bg-blue-600 text-white text-xs py-2 px-6 rounded-md shadow-md hover:bg-blue-500 gap-2",i.textContent="Descargar PDF",i.addEventListener("click",(function(){var t;t=e.id_user,window.open(`/pdf/notificaciones?id_user=${t}`,"_blank")}));const c=document.createElement("a");c.href="formularioagenda",c.className="flex items-center justify-center uppercase bg-blue-600 text-white text-xs py-2 px-6 rounded-md shadow-md hover:bg-blue-500 gap-2",c.textContent="Registrar",c.addEventListener("click",(function(){localStorage.removeItem("notificacion");const t={idx:e.idx,id_user:e.id_user,user:e.user,lastname:e.lastname,address:e.address,id_zone:e.zona,id_colony:e.colonia,id_observaciones:e.id_observaciones};localStorage.setItem("notificacion",JSON.stringify(t))}));const d=document.createElement("button");d.className="flex items-center justify-center uppercase bg-red-600 text-white text-xs py-2 px-6 rounded-md shadow-md hover:bg-red-500 gap-2",d.textContent="Eliminar",d.addEventListener("click",(()=>{var t;t=e.id_user,Swal.fire({title:"¿Estás seguro?",text:"Esta acción no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"}).then((e=>{e.isConfirmed&&fetch(`${location.origin}/notificaciones/eliminar`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_user:t})}).then((e=>e.json())).then((e=>{"success"===e.status?Swal.fire({title:"Éxito",text:e.message,icon:"success",confirmButtonText:"OK"}).then((()=>{const e=document.querySelector(`#notificacion-${t}`);e&&e.remove(),localStorage.removeItem("notificacion")})):Swal.fire({title:"Error",text:e.message,icon:"error",confirmButtonText:"OK"})})).catch((e=>{console.error("Error al eliminar:",e),Swal.fire({title:"Error",text:"Hubo un problema al eliminar la notificación",icon:"error",confirmButtonText:"OK"})}))}))})),r.appendChild(c),r.appendChild(d),r.appendChild(i),a.appendChild(s),a.appendChild(o),n.appendChild(a),n.appendChild(r),t.appendChild(n)}))}()}catch(e){console.log("Error al obtener notificaciones:",e)}}))})();